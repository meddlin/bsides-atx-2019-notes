Using the Chrome Dev Tools Protocol for Pentesting and Bug Hunting
Bsides ATX 2019
Lil Tex room

-- he's an AppSec consultant at nVisium
-- previously a .NET/Angular developer and other infosec-y things

Can change JS functions on the frontend based on server responses
In Burp, 
-- can capture response for JS code
-- look for functions
-- make changes
-- yadda, yadda
-- release to browser
This gets really tedious, forces reliance on regex
All we're interested in is chanigng the behavior of the app on the frontend

NOTE: jS frameowrks can be highly complex, and security bugs can sneak through
-- this is why we want to pentest our own applications
-- ex: you can bypass Angular to just "get" to the admin page if you want

Found an article:
-- "Intercepting and Modifying responses with Chrome via the Dectools Protocol"
-- by jsoverson, Sept. 17, 2018

check out: chromedevtools.github.io/devtools-protocol
-- things like Puppeteer and other headless Chrome tools use CDP
-- extensions for inspecting JS framework models use it as well
-- "battering ram" for Angular?

in CDP Domains
-- look at "Runtime Domain"
	-- also Network and "page" domains
-- each domain has its own set of methods

He wrote: Gorp -> github.com/DharmaOfCode/gorp
-- written in Golang
-- concurrency is easy with Go
-- debugger hooks into Chrome
-- the modules hook into the debugger
-- plugins for the modules
-- then an API above those
Take special interest in the "Inspectors" plugins
	-- "records all references to API calls made by the application by inspecing JS code"

Useful to test Mising function Level Access Control (MFLAC) vulns
	-- what is MFLAC?
Or skip validation buried inside multiple function calls (i.e. file upload)
or force apps to think you're logged in/have admin
Or verifty request formats

#### Function Hijacker Demo
After logged in
-- look at `*.min.js` file
-- check isLoggedIn, check for token
-- perhaps we can swap the function checking for isLoggedIn--> is it a naive check?
-- *here* is where we can use gorp to hijack the function
	-- start navigating around, see what's open
	-- change passwords?
	-- check more server request behavior?

#### Unhider Demo
-- Burp only unhides <input> elements, but can be extended
	-- gorp's option is useful when Burp's isn't available
-- You may want to unhide forms
	-- search DOM inspector for "hidden" attribute
-- use "gorp query" to find elements that show up

#### Forcing Angular 2+ Developer Mode Demo
After app gets bundled into minifed JS
-- here, "production mode" is enabled
You can do all of this with Burp manually, but that's tedious

-- `$0` selects the currently selected DOM element, and we can use `ng.probe()` to check
-- these don't work outside of development mode

**NOTE:** *what is Cross-origin bread blocked*?

-- once this dev mode is enabled, we can start checking state, services, more easily make changes, discover bugs
	-- essentially have a "closer look at the blueprint of hte app"
	-- we can change the tenant id
	-- any other id's?
	-- how does the server respond to that?
	-- want access to the framework router?

#### Find/Replace

-- can do this with Burp too, but tedious
-- instead of replacing a string, or function...
	-- here, just replace this whole file with my own
-- also useful if you decompile a flash app
	-- reverse engineer the binary so that YOUR binary loads instead of the SERVER's.

#### API Finder
-- finds references to API strings, saves them to a file
-- can find API calls with some code context
-- do you wnat to know what API an app is using?
-- you can even watch this record (saved to file) fill up as you browse the web app


all of this works with Reconnaissance and Enumeration
Want automated bug hunting?

Not always the greatest for finding the next big bug or anything